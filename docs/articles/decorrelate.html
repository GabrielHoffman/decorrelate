<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fast Whitening Transformation • decorrelate</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fast Whitening Transformation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">decorrelate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/decorrelate.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GabrielHoffman/decorrelate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fast Whitening Transformation</h1>
                        <h4 data-toc-skip class="author">Developed by <a href="http://gabrielhoffman.github.io/" class="external-link">Gabriel Hoffman</a>
</h4>
            
            <h4 data-toc-skip class="date">Run on 2025-07-09
13:14:39.025354</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/GabrielHoffman/decorrelate/blob/HEAD/vignettes/decorrelate.Rmd" class="external-link"><code>vignettes/decorrelate.Rmd</code></a></small>
      <div class="d-none name"><code>decorrelate.Rmd</code></div>
    </div>

    
    
<!--- 

rmarkdown::render("decorrelate.Rmd");



title: "<span style='font-size: 34px'>Fast Probabilistic Whitening Transformation for Ultra-High Dimensional Data</style>"

--->
<style>
body {
text-align: justify}
</style>
<p>Data whitening is a widely used preprocessing step to remove
correlation structure since statistical models often assume independence
<a href="https://doi.org/10.1080/00031305.2016.1277159" class="external-link">(Kessy, et
al. 2018)</a>. The typical procedures transforms the observed data by an
inverse square root of the sample correlation matrix (<strong>Figure
1</strong>). For low dimension data (i.e. <span class="math inline">n
&gt; p</span>), this transformation produces transformed data with an
identity sample covariance matrix. This procedure assumes either that
the true covariance matrix is know, or is well estimated by the sample
covariance matrix. Yet the use of the sample covariance matrix for this
transformation can be problematic since <strong>1)</strong> the
complexity is <span class="math inline">\mathcal{O}(p^3)</span> and
<strong>2)</strong> it is not applicable to the high dimensional
(i.e. <span class="math inline">n \ll p</span>) case since the sample
covariance matrix is no longer full rank.</p>
<p>Here we use a probabilistic model of the observed data to apply a
whitening transformation. Our Gaussian Inverse Wishart Empirical Bayes
(GIW-EB) <strong>1)</strong> model substantially reduces computational
complexity, and <strong>2)</strong> regularizes the eigen-values of the
sample covariance matrix to improve out-of-sample performance.</p>
<div class="figure">
<img src="decorrelate_files/figure-html/run.examples-1.png" alt="**Figure 1: Intuition for data whitening transformation**. Given the singular value decomposition of $Y/\sqrt{n}$ after centering columns is $UDV^T$, the steps in the transformation are: **A)** Original data, **B)** Data rotated along principal components, **C)** Data rotated and scaled, **D)** Data rotated, scaled and rotated back to original axes. Green arrows indicate principal axes and lengths indicate eigen-values." width="864"><p class="caption">
<strong>Figure 1: Intuition for data whitening transformation</strong>.
Given the singular value decomposition of <span class="math inline">Y/\sqrt{n}</span> after centering columns is <span class="math inline">UDV^T</span>, the steps in the transformation are:
<strong>A)</strong> Original data, <strong>B)</strong> Data rotated
along principal components, <strong>C)</strong> Data rotated and scaled,
<strong>D)</strong> Data rotated, scaled and rotated back to original
axes. Green arrows indicate principal axes and lengths indicate
eigen-values.
</p>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">decorrelate</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RfastOfficial/Rfast" class="external-link">Rfast</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span>  <span class="co"># number of samples</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">200</span>  <span class="co"># number of features</span></span>
<span></span>
<span><span class="co"># create correlation matrix</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autocorr.mat.html">autocorr.mat</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># draw data from correlation matrix Sigma</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rfast/man/rmvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">Sigma</span> <span class="op">*</span> <span class="fl">5.1</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sample_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># eclairs decomposition implements GIW-EB method: *E*stimate</span></span>
<span><span class="co"># *c*ovariance/correlation with *l*ow *r*ank and *s*hrinkage</span></span>
<span><span class="va">ecl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eclairs.html">eclairs</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># decorrelate data using eclairs decomposition</span></span>
<span><span class="va">Y_whitened</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decorrelate.html">decorrelate</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">ecl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the same whitening can be performed with one command where the eigen-value</span></span>
<span><span class="co"># shrinkage is performed internally</span></span>
<span><span class="va">Y_whitened2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/whiten.html">whiten</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></code></pre></div>
<p>Here plot <strong>A</strong>) the eigen-values of the covariance
matrix before and after shrinkage. <strong>B</strong>) The correlation
of the observed and <strong>C</strong>) whitened data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot shrinkage of eigen-values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ecl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># correlation between variables in observed data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Correlation of observed data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># decorrelate data using eclairs decomposition</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y_whitened</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Correlation of whitened data"</span><span class="op">)</span></span></code></pre></div>
<p><img src="decorrelate_files/figure-html/plots-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="advanced-usage">Advanced usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h2>
<p>The <code>decorrelate</code> package has advanced features to examine
details of the whitening transformation.</p>
<div class="section level3">
<h3 id="directly-compute-whitening-matrix">Directly compute whitening matrix<a class="anchor" aria-label="anchor" href="#directly-compute-whitening-matrix"></a>
</h3>
<p>While <code><a href="../reference/eclairs.html">eclairs()</a></code>, <code><a href="../reference/decorrelate.html">decorrelate()</a></code>, and
<code><a href="../reference/whiten.html">whiten()</a></code> perform the probabilistic whitening transformation
efficiently without directly computing the whitening matrix,
<code><a href="../reference/getWhiteningMatrix.html">getWhiteningMatrix()</a></code> can directly compute the matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute whitening matrix from eclairs decomposition</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getWhiteningMatrix.html">getWhiteningMatrix</a></span><span class="op">(</span><span class="va">ecl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># transform observed data using whitening matrix</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">W</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># evalute difference between whitened computed 2 ways</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">-</span> <span class="va">Y_whitened</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4.085621e-14</span></span></code></pre>
<p>The difference between function is due only to machine precision.</p>
</div>
<div class="section level3">
<h3 id="explicit-covariance-or-correlation">Explicit covariance or correlation<a class="anchor" aria-label="anchor" href="#explicit-covariance-or-correlation"></a>
</h3>
<p>The full covariance for correlation matrix implied by the
<code><a href="../reference/eclairs.html">eclairs()</a></code> decomposition can be computed explicitly. Note
that computing and storing these matries is <span class="math inline">O(p^2)</span>, it may not feasable for large
datasets.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute correlation matrix from eclairs</span></span>
<span><span class="fu"><a href="../reference/getCov.html">getCor</a></span><span class="op">(</span><span class="va">ecl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute covariance matrix from eclairs</span></span>
<span><span class="fu"><a href="../reference/getCov.html">getCov</a></span><span class="op">(</span><span class="va">ecl</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sample-from-multivariate-normal">Sample from multivariate normal<a class="anchor" aria-label="anchor" href="#sample-from-multivariate-normal"></a>
</h3>
<p>The form of the <code><a href="../reference/eclairs.html">eclairs()</a></code> decomposition can be used to
efficiently sample from a multivariage normal distribution with
specified covariance.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw from multivariate normal</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using eclairs decomposition</span></span>
<span><span class="va">X.draw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmvnorm_eclairs.html">rmvnorm_eclairs</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span>, <span class="va">ecl</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="low-rank-models">Low-rank models<a class="anchor" aria-label="anchor" href="#low-rank-models"></a>
</h3>
<p>A low rank <code><a href="../reference/eclairs.html">eclairs()</a></code> decomposition can be computed more
efficiently when <span class="math inline">k</span> is small relative to
<span class="math inline">min(n,p)</span>. Importantly, the emprical
Bayes estimate of the shrinkage parameter <span class="math inline">\lambda</span> can still be computed accurately for
sufficiently large <span class="math inline">k</span>. Note that the low
rank method trades computational efficientcy for accuracy in the
whitening transform.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use low rank decomposition with 50 components</span></span>
<span><span class="va">ecl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eclairs.html">eclairs</a></span><span class="op">(</span><span class="va">Y</span>, k <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># decorrelate data using eclairs decomposition</span></span>
<span><span class="va">Y_whitened</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decorrelate.html">decorrelate</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">ecl</span><span class="op">)</span></span></code></pre></div>
<p><img src="decorrelate_files/figure-html/plots2-1.png" width="864"></p>
<p>In this case, the low rank whitening produces transformed features
that are approximately independent. The approximation improves as the
rank increases.</p>
</div>
<div class="section level3">
<h3 id="computing-condition-number">Computing condition number<a class="anchor" aria-label="anchor" href="#computing-condition-number"></a>
</h3>
<p>Compute the condition number (i.e. the ratio between the largest and
smallest eigen-value) of the correlation/covariance matrix from the
<code><a href="../reference/eclairs.html">eclairs()</a></code> decomposition.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/kappa.html" class="external-link">kappa</a></span><span class="op">(</span><span class="va">ecl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 658.3446</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="removing-correlation-vs-covariance">Removing correlation vs covariance<a class="anchor" aria-label="anchor" href="#removing-correlation-vs-covariance"></a>
</h3>
<p>By default <code><a href="../reference/eclairs.html">eclairs()</a></code> computes the <em>covariance</em>
between columns by using the default
<code>compute = "covariance"</code>. Running <code><a href="../reference/decorrelate.html">decorrelate()</a></code>
using this removes the covariance between columns. Setting
<code>compute = "correlation"</code>, evaluates and then removes
correlation between columns while retaining the variance.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clusterGeneration</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate covariance matrix, where the diagonals (i.e. variances) vary</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterGeneration/man/genPositiveDefMat.html" class="external-link">genPositiveDefMat</a></span><span class="op">(</span><span class="va">p</span>, rangeVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1e+06</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Sigma</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rfast/man/rmvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># examine variances of the first 5 variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Y</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5.082884 2.853566 1.083664 3.687911 1.491565</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># transform removes covariance between columns so variance of transformed</span></span>
<span><span class="co"># features are *approximately* equal</span></span>
<span><span class="va">ecl_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eclairs.html">eclairs</a></span><span class="op">(</span><span class="va">Y</span>, compute <span class="op">=</span> <span class="st">"covariance"</span><span class="op">)</span></span>
<span><span class="va">Z1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decorrelate.html">decorrelate</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">ecl_cov</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># variance are *approximately* equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Z1</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9830960 0.9939579 0.9924317 0.9939929 0.9945367</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># transform removes **correlation** between columns but variables are not</span></span>
<span><span class="co"># scaled</span></span>
<span><span class="va">ecl_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eclairs.html">eclairs</a></span><span class="op">(</span><span class="va">Y</span>, compute <span class="op">=</span> <span class="st">"correlation"</span><span class="op">)</span></span>
<span><span class="va">Z2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decorrelate.html">decorrelate</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">ecl_cor</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># variances are not standardized</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Z2</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5.012871 2.830468 1.066778 3.661699 1.476049</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<details><pre><code><span><span class="co">## R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin22.4.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Ventura 13.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Users/gabrielhoffman/prog/R-4.3.0/lib/libRblas.dylib </span></span>
<span><span class="co">## LAPACK: /usr/local/Cellar/r/4.3.0_1/lib/R/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: America/New_York</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] clusterGeneration_1.3.7 MASS_7.3-60             latex2exp_0.9.6        </span></span>
<span><span class="co">## [4] colorRamps_2.3.1        cowplot_1.1.1           ggplot2_3.4.2          </span></span>
<span><span class="co">## [7] mvtnorm_1.2-2           decorrelate_0.0.18     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] generics_0.1.3     sass_0.4.6         utf8_1.2.3         stringi_1.7.12    </span></span>
<span><span class="co">##  [5] lattice_0.21-8     digest_0.6.33      magrittr_2.0.3     evaluate_0.21     </span></span>
<span><span class="co">##  [9] grid_4.3.0         fastmap_1.1.1      rprojroot_2.0.3    jsonlite_1.8.5    </span></span>
<span><span class="co">## [13] Matrix_1.5-4.1     formatR_1.14       purrr_1.0.1        fansi_1.0.4       </span></span>
<span><span class="co">## [17] scales_1.2.1       codetools_0.2-19   textshaping_0.3.6  jquerylib_0.1.4   </span></span>
<span><span class="co">## [21] Rdpack_2.4         cli_3.6.1          rlang_1.1.1        rbibutils_2.2.13  </span></span>
<span><span class="co">## [25] munsell_0.5.0      withr_2.5.0        CholWishart_1.1.2  cachem_1.0.8      </span></span>
<span><span class="co">## [29] yaml_2.3.7         tools_4.3.0        parallel_4.3.0     memoise_2.0.1     </span></span>
<span><span class="co">## [33] dplyr_1.1.2        corpcor_1.6.10     colorspace_2.1-0   Rfast_2.0.7       </span></span>
<span><span class="co">## [37] RcppZiggurat_0.1.6 vctrs_0.6.3        R6_2.5.1           lifecycle_1.0.3   </span></span>
<span><span class="co">## [41] stringr_1.5.0      fs_1.6.2           ragg_1.2.5         irlba_2.3.5.1     </span></span>
<span><span class="co">## [45] pkgconfig_2.0.3    desc_1.4.2         pkgdown_2.0.7      bslib_0.4.2       </span></span>
<span><span class="co">## [49] pillar_1.9.0       gtable_0.3.3       glue_1.6.2         Rcpp_1.0.11       </span></span>
<span><span class="co">## [53] whitening_1.4.0    systemfonts_1.0.4  highr_0.10         tidyselect_1.2.0  </span></span>
<span><span class="co">## [57] xfun_0.39          tibble_3.2.1       knitr_1.43         farver_2.1.1      </span></span>
<span><span class="co">## [61] htmltools_0.5.5    labeling_0.4.2     rmarkdown_2.22     compiler_4.3.0</span></span></code></pre>
</details>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://gabrielhoffman.github.io" class="external-link">Gabriel Hoffman</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
